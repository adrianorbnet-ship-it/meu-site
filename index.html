<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ca√ßa √†s Ru√≠nas ‚Äî Jogo B√≠blico Interativo</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  body {
    margin:0; padding:0;
    font-family: Arial, sans-serif;
    background:#ecf0f1;
  }

  /* BARRA SUPERIOR */
  #info-bar {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    background: #2c3e50;
    color: white;
    padding: 15px 20px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.4);
    z-index: 1001;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: space-between;
    transition: background 0.3s ease;
  }

  .info-item {
    margin: 5px 15px;
    flex-grow: 1;
  }

  #dica-texto { font-size: 1.4em; font-weight: bold; }
  #tempo {
    font-size: 1.6em;
    font-weight: bold;
    background: #34495e;
    padding: 5px 12px;
    border-radius: 8px;
  }

  button {
    font-size: 1.2em;
    padding: 8px 15px;
    cursor:pointer;
    background:#3498db;
    color:white;
    border:none;
    border-radius:6px;
    transition: background 0.3s;
  }
  button:hover { background:#2980b9; }

  #map { height: 600px; width: 100%; margin-top: 85px; display: none; }

  .etiqueta {
    background: rgba(255,255,255,0.85);
    padding: 3px 6px;
    border-radius: 4px;
    border: 1px solid #555;
    font-size: 13px;
    font-weight: bold;
  }

  /* TELA DE INSTRU√á√ïES */
  #tela-inicial {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(44, 62, 80, 0.97);
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 30px;
    z-index: 2000;
  }

  #tela-inicial h1 {
    font-size: 2.5em;
    margin-bottom: 20px;
  }

  #tela-inicial p {
    font-size: 1.2em;
    max-width: 700px;
    line-height: 1.6;
    margin-bottom: 25px;
  }

  #tela-inicial button {
    background: #27ae60;
    font-size: 1.3em;
    padding: 12px 25px;
    border: none;
    border-radius: 8px;
    color: white;
    cursor: pointer;
    transition: background 0.3s;
  }

  #tela-inicial button:hover {
    background: #2ecc71;
  }

</style>
</head>
<body>

<!-- BARRA SUPERIOR -->
<div id="info-bar">
  <div class="info-item"><strong>Dica:</strong> <span id="dica-texto">Aguardando in√≠cio do jogo...</span></div>
  <div class="info-item"><strong>Tempo:</strong> <span id="tempo">--</span></div>
  <div class="info-item" style="text-align:right;"><button onclick="reiniciar()">üîÑ Reiniciar</button></div>
</div>

<!-- MAPA -->
<div id="map"></div>

<!-- SONS -->
<audio id="bip-som" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
<audio id="tempo-fim-som" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>
<audio id="vitoria-som" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>

<!-- TELA INICIAL -->
<div id="tela-inicial">
  <h1>üó∫Ô∏è Jogo B√≠blico: Ca√ßa √†s Ru√≠nas</h1>
  <p>
    Bem-vindo ao desafio interativo! üåç  
    Seu objetivo √© encontrar no mapa os lugares hist√≥ricos da B√≠blia, usando as <strong>dicas</strong> exibidas no topo da tela.  
    Clique nas regi√µes do mapa e descubra se est√° <strong>mais ao norte, sul, leste ou oeste</strong> at√© acertar o local correto.<br><br>
    ‚è±Ô∏è Voc√™ ter√° <strong>30 segundos</strong> para cada tentativa.<br>
    üéß Ou√ßa os sons do tempo e da vit√≥ria.<br><br>
    Boa sorte, explorador!
  </p>
  <button onclick="iniciarJogo()">‚ñ∂Ô∏è Iniciar Jogo</button>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
function paraArabe(numero) {
  const arabicNums = ['Ÿ†','Ÿ°','Ÿ¢','Ÿ£','Ÿ§','Ÿ•','Ÿ¶','Ÿß','Ÿ®','Ÿ©'];
  return numero.toString().split('').map(d => arabicNums[d] || d).join('');
}

const bipSom = document.getElementById('bip-som');
const tempoFimSom = document.getElementById('tempo-fim-som');
const vitoriaSom = document.getElementById('vitoria-som');

const map = L.map('map').setView([30.0, 35.3], 6);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 18 }).addTo(map);

const ruinas = [
  { nome: "Monte Horebe", lat: 29.99, lng: 35.65, ano: 1400, dica: "Montanha sagrada do encontro com Deus" },
  { nome: "Jeric√≥", lat: 31.8667, lng: 35.4500, ano: 8000, dica: "Muralhas ca√≠ram com trombetas" },
  { nome: "Petra", lat: 30.3285, lng: 35.4444, ano: 312, dica: "Cidade rosa esculpida em rocha" },
  { nome: "Monte Carmelo", lat: 32.9246, lng: 35.0836, ano: 900, dica: "Profetas de Baal" },
  { nome: "Monte das Oliveiras", lat: 31.778, lng: 35.243, ano: 33, dica: "Jesus suou gotas de sangue" },
  { nome: "Vale do Armagedom", lat: 32.583, lng: 35.600, ano: 0, dica: "Batalha final do Apocalipse" },
  { nome: "Lugar de D√©bora", lat: 32.333, lng: 35.300, ano: 1100, dica: "Onde D√©bora pregava" },
  { nome: "√öltima viagem de Paulo", lat: 36.000, lng: 28.000, ano: 60, dica: "Viagem final de Paulo" },
  { nome: "Cidade do pai de Abra√£o", lat: 32.500, lng: 44.400, ano: 2000, dica: "Local de resid√™ncia do pai de Abra√£o" },
  { nome: "Sa√≠da da rainha de Sab√°", lat: 15.500, lng: 38.500, ano: 950, dica: "Viagem da rainha de Sab√°" }
];

ruinas.forEach(r => {
  L.circle([r.lat, r.lng], { radius: 500, color: '#888', fillOpacity: 0.3 }).addTo(map);
  const etiqueta = L.divIcon({ className: 'etiqueta', html: r.nome, iconAnchor: [0,0] });
  L.marker([r.lat, r.lng], { icon: etiqueta, interactive: false }).addTo(map);
});

map.fitBounds(ruinas.map(r => [r.lat, r.lng]), { padding: [50,50] });

let escolhido;
let marcador = null;
let tempo = 30;
let timer;
let jogoAtivo = false;

function escolherRuina() {
  escolhido = ruinas[Math.floor(Math.random() * ruinas.length)];
  document.getElementById('dica-texto').textContent = escolhido.dica;
}

function direcaoDoClick(ruina, clique) {
  const latDif = ruina.lat - clique.lat;
  const lngDif = ruina.lng - clique.lng;
  let direcao = [];
  if (latDif > 0.1) direcao.push("Mais ao norte");
  else if (latDif < -0.1) direcao.push("Mais ao sul");
  if (lngDif > 0.1) direcao.push("Mais a leste");
  else if (lngDif < -0.1) direcao.push("Mais a oeste");
  return direcao.join(" e ") || "Muito pr√≥ximo!";
}

function iniciarTimer() {
  document.getElementById('tempo').textContent = `${tempo}s`;
  timer = setInterval(() => {
    tempo--;
    document.getElementById('tempo').textContent = `${tempo}s`;
    if (tempo > 0) bipSom.play();
    if (tempo < 0) {
      clearInterval(timer);
      tempoFimSom.play();
      document.getElementById('dica-texto').textContent = `‚è∞ Acabou o tempo! A ru√≠na era ${escolhido.nome}.`;
      jogoAtivo = false;
    }
  }, 1000);
}

function reiniciar() {
  if (!jogoAtivo) return;
  clearInterval(timer);
  if (marcador) { map.removeLayer(marcador); marcador = null; }
  tempo = 30;
  escolherRuina();
  iniciarTimer();
}

map.on('click', e => {
  if (!jogoAtivo) return;
  const distancia = map.distance(e.latlng, escolhido);
  if (distancia < 15000) {
    clearInterval(timer);
    vitoriaSom.play();
    marcador = L.marker([escolhido.lat, escolhido.lng]).addTo(map)
      .bindPopup(`üéâ Parab√©ns! Voc√™ encontrou ${escolhido.nome}!<br>Ano: ${paraArabe(escolhido.ano)}`)
      .openPopup();
    document.getElementById('dica-texto').textContent = "‚úÖ Acertou!";
    jogoAtivo = false;
  } else {
    const dica = direcaoDoClick(escolhido, e.latlng);
    document.getElementById('dica-texto').textContent = `${escolhido.dica} ‚Äî ${dica}`;
  }
});

function iniciarJogo() {
  document.getElementById('tela-inicial').style.display = 'none';
  document.getElementById('map').style.display = 'block';
  jogoAtivo = true;
  escolherRuina();
  iniciarTimer();
}

function iniciarJogo() {
  document.getElementById('tela-inicial').style.display = 'none';
  document.getElementById('map').style.display = 'block';
  map.invalidateSize(); // üëà for√ßa o mapa a recalcular o tamanho
  jogoAtivo = true;
  escolherRuina();
  iniciarTimer();
}

</script>
</body>
</html>